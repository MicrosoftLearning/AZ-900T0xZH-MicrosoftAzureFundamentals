---
wts:
    title: '06 - 创建 SQL 数据库（5 分钟）'
    module: '模块 02 - 核心 Azure 服务（工作负载）'
---

# 06 - 创建 SQL 数据库

在本演练中，我们将在 Azure 中创建一个 SQL 数据库，然后查询该数据库中的数据。

# 任务 1：创建数据库（5 分钟）

在此任务中，我们将使用 AdventureWorksLT 示例数据库创建一个新的 SQL 数据库。 

1. 登录 Azure 门户网站：[**https://portal.azure.com**](https://portal.azure.com)。

2. 搜索并选择 **SQL 数据库**，然后单击 **+ 添加**。 

3. 在 **基本信息** 选项卡中，填写以下信息。  

    | 设置 | 数值 | 
    | --- | --- |
    | 订阅 | **选择你的订阅** |
    | 资源组 | **myRGDb** （新建） |
    | 数据库名| **db1** | 
    | | |

3. 在 **服务器** 旁边，单击 **新建** 并输入此信息。完成后，单击 **确定**。

    | 设置 | 数值 | 
    | --- | --- |
    | 服务器名称 | **sqlserverxxx** （必须是唯一的） | 
    | 服务器管理员登录： | **sqluser** |
    | 密码 | **Pa$$w0rd1234** |
    | 地点 | **(美国) 美国东部** |
    | 允许 Azure 服务访问服务器 | **选中框** |
    | | |

   ![此屏幕截图显示了“服务器”窗格和“新建服务器”窗格，其中包含根据表填充的字段和突出显示的“选择”按钮。](../images/0501.png)

4.转到 **“网络”** 选项卡，然后配置以下设置（其他设置保留为其默认设置）。 

    | 设置 | 值 | 
    | --- | --- |
    | 连接方法 | **公共终结点** |    
    | 允许 Azure 服务和资源访问此服务器 | **是** |
    | 添加当前客户端 IP 地址 | **否** |
    | | |
    
   ![“创建 SQL 数据库”边栏选项卡的“网络”选项卡的屏幕截图，其中已根据表选择了设置，并且突出显示了“查看 + 创建”按钮。](../images/0501b.png)

5. 移动至 **其他设置** 选项卡。我们将使用 AdventureWorksLT 示例数据库。

    | 设置 | 数值 | 
    | --- | --- |
    | 使用现有数据 | **示例** | 
    | 排序规则 | **使用默认设置** |
    | 启用高级数据安全 | **暂不** |
    | | |

    ![“创建 SQL 数据库”边栏选项卡的“其他设置”选项卡的屏幕截图，其中已根据表选择了设置，并且突出显示了“查看 + 创建”按钮。](../images/0501c.png)

6. 单击 **查看 + 创建**，然后单击 **创建** 以部署和预配资源组、服务器和数据库。部署大约需要 2 到 5 分钟。

7. 监视你的部署。 

# 任务 2：测试数据库。

在此任务中，我们将配置 SQL Server 并运行 SQL 查询。 

1. 搜索 **SQL 数据库** 并确保已创建新数据库。你可能需要 **刷新** 页面。

    ![刚刚部署的 SQL 数据库和服务器的屏幕截图。](../images/0502.png)

2. 打开创建的 SQL 数据库 **db1**，然后选择 **查询编辑器(预览)**。

3. 使用密码 **Pa$$w0rd1234** 以 **sqluser** 身份登录。

4. 你将无法登录。请仔细阅读错误，并记下需要通过防火墙的 IP 地址。 

    ![此屏幕截图显示了包含 IP 地址错误的“查询编辑器”登录页面。](../images/0503.png)

5. 搜索 **SQL Server**，选择你的 SQL Server。 

    ![“SQL Server”页面的屏幕截图。](../images/0504.png)

6. 从 SQL Server **概述** 边栏选项卡，单击 **显示防火墙设置**。

7. 单击 **添加客户端 IP** （顶部菜单栏），然后从错误页面添加 IP 地址。请务必 **保存** 更改。 

    ![此屏幕截图显示了“SQL Server 防火墙设置”页面，其中突出显示了新的 IP 规则。](../images/0506.png)

8. 返回你的 SQL 数据库和“查询编辑器(预览)”登录页面。尝试使用密码 **Pa$$w0rd1234** 以 **sqluser** 身份重新登录。此次应尝试成功。请注意，部署新的防火墙规则可能需要几分钟时间。 

9. 成功登录后，将出现查询窗格，在编辑器窗格中输入以下查询。

```SQL
SELECT TOP 20 pc.Name as CategoryName, p.name as ProductName
FROM SalesLT.ProductCategory pc
JOIN SalesLT.Product p
ON pc.productcategoryid = p.productcategoryid;
```

    ![此屏幕截图显示了“查询”编辑器，其中包含“查询”窗格和成功执行的命令。](../images/0507.png)

4. 选择 **运行**，然后在 **结果** 窗格中查看查询结果。查询应该成功运行。

    ![此屏幕截图显示了数据库“查询编辑器”窗格，其中 SQL 代码已成功运行，并且输出在“结果”窗格中可见。](../images/0508.png)

恭喜！你已在 Azure 中创建了一个 SQL 数据库，并成功查询了该数据库中的数据。

**注意**：为避免产生额外费用，你可以删除此资源组。搜索资源组，单击你的资源组，然后单击 **删除资源组**。验证资源组的名称，然后单击 **删除**。关注 **通知**，了解删除操作的进度。